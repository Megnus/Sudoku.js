<html>
<head>
<style type="text/css">
</style>
</head>
<meta charset="UTF-8">

<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>


	var cube = [];

	// rek(10);

	// function rek(x) {
	// 	if ( x !=  0 )
	// 		rek(x--);

	// }

	function makeBoard() {
		var i,j;
		var row = new Array(9);
		var plane = [];

		for (i = 0; i < 9; i++) {
			for (j = 0; j < 9; j++)
				plane.push(new Array(10));
			cube.push(plane);
			plane = [];
		}

		for (i = 0; i < 9; i++)
			for (j = 0; j < 9; j++)
				for (k = 0; k < 10; k++)
					cube[i][j][k] = k;


		// cube[0][0][0] = 1;
		// cube[0][1][0] = 2;
		// cube[0][2][0] = 3;
		// cube[1][0][0] = 4;
		// cube[1][1][0] = 5;
		// cube[1][2][0] = 6;
		// cube[2][0][0] = 7;
		// cube[2][1][0] = 8;

		cube[0][0][0] = 0;
		cube[0][0][1] = 0;
		cube[0][0][2] = 2;
		cube[0][0][3] = 0;
		cube[0][0][4] = 0;
		cube[0][0][5] = 0;
		cube[0][0][6] = 0;
		cube[0][0][7] = 0;
		cube[0][0][8] = 0;
		cube[0][0][9] = 0;

		cube[1][1][0] = 0;
		cube[1][1][1] = 0;
		cube[1][1][2] = 2;
		cube[1][1][3] = 3;
		cube[1][1][4] = 0;
		cube[1][1][5] = 0;
		cube[1][1][6] = 0;
		cube[1][1][7] = 0;
		cube[1][1][8] = 0;
		cube[1][1][9] = 0;


		// filterQuadrants();
		// filterRowCol();
		// filterRaw();
		// setRaw();

		// filterQuadrants();
		// filterRowCol();
		// filterRaw();
		// setRaw();

		checkFirst();

		//compare();

		for (i = 0; i < 10; i++) {
			printCube(i);
		}

		//console.log(
			//compareAssociativeArrays([1,2],[1,3])
		//);
	}
	/*** compare arrays *********************/

	// function returnNumberOfVal(array) {
	// 	var num = 0;
	// 	for (var i in array) {
	// 		if ( array[i] != 0)
	// 			num++;
	// 	}
	// 	retunr num;
	// }

	function point(x,y) {
		this.x = x;
		this.y = y;
	}

	function checkFirst() {

		//var array = getQuadrant(0,0);
		//var array = getRow(0,0);
		var rowArray = getRows();
		var colArray = getColumns();
		var quadrantArray = getQuadrants();

		for (var x = 0; x < 9; x++) {
			for (var y = 0; y < 9; y++) {

				arrayFilter(x, y, colArray[y]);
				arrayFilter(x, y, rowArray[x]);
				arrayFilter(x, y, quadrantArray[parseInt(x / 3)][parseInt(y / 3)]);
			}
		}


	}

	/********* Get area-array *********/

	function getQuadrants() {
		var array = [];
		var tempArray = [];
		for (var i = 0; i < 3; i++) {
			for (var j = 0; j < 3; j++)
				tempArray.push(getQuadrant(i,j));
			array.push(tempArray);
			tempArray = [];
		}
		return array;
	}

	function getQuadrant(n,m) {
		var array = [];
		for (var i = n * 3; i < (n + 1) * 3; i++)
			for (var j = m * 3; j < (m + 1) * 3; j++)
					array.push(new point(i,j));
		return array;
	}

	function getColumns() {
		var array = [];
		for (var i = 0; i < 9; i++) {
			array.push(getColumn(i));
		}
		return array;
	}

	function getColumn(x) {
		var array = [];
		for (var i = 0; i < 9; i++)
			array.push(new point(x,i));
		return array;
	}

	function getRows() {
		var array = [];
		for (var i = 0; i < 9; i++) {
			array.push(getRow(i));
		}
		return array;
	}

	function getRow(y) {
		var array = [];
		for (var i = 0; i < 9; i++)
				array.push(new point(i,y));
		return array;
	}

	/************* Filter ***********/

	function singleValFilter(x,y,array) { // make sure that in it is one value in first layer then all i set...
		if ( arrayValCount(cube[x][y]) === 1 ) {
			for (var k = 1; k < cube[x][y].length; k++ ) {
				if (cube[x][y][k] != 0) {
					break;
				}
			}
			cube[x][y][0] = cube[x][y][k];
			for (var i in array) {
				if (array[i].x != x || array[i].y != y)
					cube[array[i].x][array[i].y][k] = 0;
			}
			return true;
		}
		return false;
	}


	function arrayFilter(x,y,array) {
		var i, j, k, count = 0;
		var temp = [];
		var flag;

		if (singleValFilter(x, y, array))
			return;

		for (i in array)
			if (compareAssociativeArrays( cube[x][y], cube[array[i].x][array[i].y] )) {
				count++;
				temp.push(array[i]);
			}

		if (count >= arrayValCount(cube[x][y])) {
			for(k = 1; k < 10; k++) {
				if (cube[x][y][k] > 0) {
					for (i in array) {
						flag = false;
						for (var z in temp)
							if ( array[i].x === temp[z].x && array[i].y === temp[z].y)
								flag = true;
						if (!flag)
							cube[array[i].x][array[i].y][k] = 0;
					}
				}
			}
		}
	}

	/* Sub methods */

	function arrayValCount(array) { /* Used in: singleValFilter, arrayFilter */
		var count = 0;
		for (var i = 1; i < array.length; i++)
			if (array[i] > 0) {
				//console.log(array[i]);
				count++;
			}
		return count;
	}

	function compareAssociativeArrays(a, b) { /* Used in: arrayFilter */
		if (a == b)
			return true;

		if (nrKeys(a) != nrKeys(b))
			return false;

		for (key in a) {
			if (a[key] != b[key])
				return false;
		}

		return true;
	}

	function nrKeys(a) { /* Used in: compareAssociativeArrays */
		var i = 0;
		for (key in a)
			i++;
		return i;
	}
	/*****************************************/

	function setRaw() {
		var count, pos;
		for (i = 0; i < 9; i++)
		{
			for (j = 0; j < 9; j++)
			{
				if ( cube[i][j][0] === 0) {
					count = 0;

					for (k = 1; k < 10; k++)
					{
						if (cube[i][j][k] != 0)
						{
							count++;
							pos = cube[i][j][k];
						}
					}

					if (count === 1) {

						cube[i][j][0] = pos;
					}
				}
			}
		}
	}

	function filterRaw() {
		var i, j;
		for (i = 0; i < 9; i++)
			for (j = 0; j < 9; j++)
				for (k = 1; k < 10; k++)
					if (cube[i][j][0] != 0)
						cube[i][j][k] = 0;
	}
	/**********************/
	function filterQuadrants() {
		for (i = 0; i < 3; i++)
			for (j = 0; j < 3; j++)
				removeVal(3 * i, 3 * (i + 1), 3 * j, 3 * (j + 1));
	}

	function removeVal(min_i, max_i, min_j, max_j) { /* oboslete/ineffective algoritm*/
		var i, j, x, y
		for (i = min_i; i < max_i; i++)
			for (j = min_j; j < max_j; j++)
				if (cube[i][j][0] != 0)
					for (x = min_i; x < max_i; x++)
						for (y = min_j; y < max_j; y++)
							cube[x][y][cube[i][j][0]] = 0;
	}

	/**********************/
	function filterRowCol() {
		var i, j;
		for (i = 0; i < 9; i++)
			for (j = 0; j < 9; j++)
				xRay(i, j);
	}

	function xRay(x,y) {
		var i, val = cube[x][y][0];
		if (val != 0) {
			for (i = 0; i < 9; i++)
				cube[i][y][val] = 0;

			for (i = 0; i < 9; i++)
				cube[x][i][val] = 0;
		}
	}
	/**********************/

	function printCube(layerVal) {

		var str = "";
		for (j = 0; j < 9; j++) {
			for (i = 0; i < 9; i++)
				str += cube[i][j][layerVal];
			console.log(str);
			str = "";
		}
		console.log('-----------');
	}

	$(document).ready(function() {


		makeBoard()


		// Handler for .ready() called.

	});

</script>

<body>

</body>
</html>