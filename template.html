<html>
<head>
<style type="text/css">
</style>
</head>
<meta charset="UTF-8">

<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>

	var cube = [];

	function makeBoard() {
		var i,j;
		var row = new Array(9);
		var plane = [];

		for (i = 0; i < 9; i++) {
			for (j = 0; j < 9; j++)
				plane.push(new Array(10));
			cube.push(plane);
			plane = [];
		}

		for (i = 0; i < 9; i++)
			for (j = 0; j < 9; j++)
				for (k = 0; k < 10; k++)
					cube[i][j][k] = k;

		// cube[0][0][0] = 1;
		// cube[0][1][0] = 2;
		// cube[0][2][0] = 3;
		// cube[1][0][0] = 4;
		// cube[1][1][0] = 5;
		// cube[1][2][0] = 6;
		// cube[2][0][0] = 7;
		// cube[2][1][0] = 8;

		// cube[0][0][0] = 0;
		// cube[0][0][1] = 0;
		// cube[0][0][2] = 2;
		// cube[0][0][3] = 3;
		// cube[0][0][4] = 0;
		// cube[0][0][5] = 0;
		// cube[0][0][6] = 0;
		// cube[0][0][7] = 0;
		// cube[0][0][8] = 0;
		// cube[0][0][9] = 0;

		cube[6][0][0] = 0;
		cube[6][0][1] = 0;
		cube[6][0][2] = 0;
		cube[6][0][3] = 3;
		cube[6][0][4] = 0;
		cube[6][0][5] = 0;
		cube[6][0][6] = 0;
		cube[6][0][7] = 0;
		cube[6][0][8] = 0;
		cube[6][0][9] = 0;

		cube[6][2][0] = 0;
		cube[6][2][1] = 0;
		cube[6][2][2] = 0;
		cube[6][2][3] = 3;
		cube[6][2][4] = 4;
		cube[6][2][5] = 0;
		cube[6][2][6] = 0;
		cube[6][2][7] = 0;
		cube[6][2][8] = 0;
		cube[6][2][9] = 0;

		var colArray = getArray( 9, obversePoint ),
			rowArray = getArray( 9, reversedPoint ),
			quadrantArray = getQuadrants();

		quadraticIteration(0, 9, function(x,y) {
				arrayFilter(x, y, colArray[x]);
				arrayFilter(x, y, rowArray[y]);
				arrayFilter(x, y, quadrantArray[parseInt(x / 3)][parseInt(y / 3)]);
			})

		singleIteration(0, 10, function(x) {
				printCube(x);
			});
	}

	/********* objects *********/

	function point(x,y) {
		this.x = x;
		this.y = y;
	}

	obversePoint = function(x,y) {
		return new point(x,y);
	}

	reversedPoint = function(x,y) {
		return new point(y,x);
	}

	/********* Get arrays *********/

	function getQuadrants() {
		var array = [],
			getQuadrant = function(n,m) {
				doubleIteration(n * 3, (n + 1) * 3, m * 3, (m + 1) * 3, function(i,j) {
					array.push(obversePoint(i,j));
				} );
			}
		return getArray(3, getQuadrant);
	}

	function getArray(max, func) {
		var array = [],
			tempArray = [];
		for (var i = 0; i < max; i++) {
			for (var j = 0; j < max; j++)
				tempArray.push(func(i,j));
			array.push(tempArray);
			tempArray = [];
		}
		return array;
	}

	/***** Iteration methods *****/

	function quadraticIteration(min, max, func) {
		doubleIteration(min, max, min, max, func);
	}

	function doubleIteration(min_x, max_x, min_y, max_y, func) {
		for (var x = min_x; x < max_x; x++)
			for (var y = min_y; y < max_y; y++)
				func(x,y);
	}

	function singleIteration(min, max, func) {
		for (var x = min; x < max; x++)
			func(x);
	}

	/************* Filter ***********/

	function initFilter() {
		for (var i = 0; i < 9; i++)
			for (var j = 0; j < 9; j++)
				if (cube[i][j][0] != 0)
					for (var k = 1; k < 10; k++)
						if (k != cube[i][j][0])
							cube[i][j][k] = 0;
						else
							cube[i][j][k] = k;
	}

	function singleValFilter(x,y,array) { // make sure that in it is one value in first layer then all i set...
		if ( arrayValCount(cube[x][y]) === 1 ) {
			for (var k = 1; k < cube[x][y].length; k++ ) {
				if (cube[x][y][k] != 0) {
					break;
				}
			}
			cube[x][y][0] = cube[x][y][k];
			for (var i in array) {
				if (array[i].x != x || array[i].y != y) {
					cube[array[i].x][array[i].y][k] = 0;
					console.log(array[i].x + ' ' + array[i].y);
				}
			}
			return true;
		}
		return false;
	}

	function arrayFilter(x,y,array) {
		var i, j, k, count = 0;
		var temp = [];
		var flag;

		if (singleValFilter(x, y, array))
			return;

		for (i in array)
			if (compareAssociativeArrays( cube[x][y], cube[array[i].x][array[i].y] )) {
				count++;
				temp.push(array[i]);
			}

		if (count >= arrayValCount(cube[x][y])) {
			for(k = 1; k < 10; k++) {
				if (cube[x][y][k] > 0) {
					for (i in array) {
						flag = false;
						for (var z in temp)
							if ( array[i].x === temp[z].x && array[i].y === temp[z].y)
								flag = true;
						if (!flag)
							cube[array[i].x][array[i].y][k] = 0;
					}
				}
			}
		}
	}

	/******* Sub methods ******/

	function arrayValCount(array) { /* Used in: singleValFilter, arrayFilter */
		var count = 0;
		for (var i = 1; i < array.length; i++)
			if (array[i] > 0) {
				//console.log(array[i]);
				count++;
			}
		return count;
	}

	function compareAssociativeArrays(a, b) { /* Used in: arrayFilter */

		if (a == b)
			return true;

		if (nrKeys(a) != nrKeys(b))
			return false;

		for (key in a) {
			if (a[key] != b[key])
				return false;
		}

		function nrKeys(a) {
			var i = 0;
			for (key in a)
				i++;
			return i;
		}

		return true;
	}

	/*************************/

	function printCube(layerVal) {

		var str = "";
		for (j = 0; j < 9; j++) {
			for (i = 0; i < 9; i++)
				str += cube[i][j][layerVal];
			console.log(str);
			str = "";
		}
		console.log('-----------');
	}

	$(document).ready(function() {


		makeBoard()


		// Handler for .ready() called.

	});

</script>

<body>

</body>
</html>